---
apiVersion: flux.weave.works/v1beta1
kind: HelmRelease
metadata:
  name: influx
  namespace: home
  annotations:
    flux.weave.works/automated: "true"
    flux.weave.works/tag.chart-image: semver:~1.7
spec:
  releaseName: home-influx
  chart:
    repository: https://kubernetes-charts.storage.googleapis.com/
    name: influxdb
    version: '1.1.3'
  values:
    image:
      repository: influxdb
      tag: '1.7.4'
    config:
      http:
        auth_enabled: true
    setDefaultUser:
      enabled: true
      user:
        username: home_assistant
    env:
    - name: INFLUXDB_DB
      value: home_assistant
    persistence:
      enabled: true
      useExisting: true
      name: influx
  valueFileSecrets:
  - name: influx-secret
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: influx
  namespace: home
spec:
  storageClassName: local-storage
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 8Gi
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: influx-secret
  namespace: home
spec:
  encryptedData:
    values.yaml: AgA9ZzMN0NzyZuCdtf3x2IZR9J4vo+IULuRAdMUiEDFbAy7DaUZynWlw/2uPn/5cg1thOzjPopa9wmB3+QcPePpzpTztrIf0Gae4dKpmIgNNywUhj1PLGDLeJNxY9nbj5EDwRnSrFUNQleF7oW8aa35rxPBop+iVCRuKAJHcRNbab0NTRHYCP3d/3XZT0rUrrUDpMXJW2ZdvCB3ds5er+MHDMNDGkNovDHuwAo36hjHm5iA+alKHdZxA1qIPm2VrZdzhJtwt+3TC94TIumkucUVQSB9AOU8U6pDt6bSYTceliYNdEHF6zABB3Gsu4oVEdbQcJd38NEPWf2Zp0xaYwu4crFgVTeLP1vHKY8f1RSxZbTTliqknMUgOYgT+rXVFeYJobdrdbtarbk6sLcAqyjb3GYwQo73T+EIE9oH4BWDOTaOrgEiwe6K3WkL4Jdb2hoWL70ZeBem1+EpgdLv7k12wFrO4+ComtFiY69MHY0OCKJsKxsZ9K9L8RXaYdkeI3PMkhkYPSkSVYT8wzPvjfnEXpntnqwXrwtm65jeD2Qfx6fDekSqNkYpk8cExaMMKJz+DZ/joDTd8g0zNpG601kBITZJDt/OUNf/BSGwZEgKgZfQ9HWqvi8u6T6/oNSmWrWaAHNzKjYbGLh/XkuZfMQaN3WG8H0nohk0UR/F3CXdg3T97qI/P8S7rMLPVl5gKeOsYTkoFaG9wZyn9/551Qlf9dJxilqBowrYfGVwCzdasPFECGWjTV/r2BNiQB8nyIT9odoRHEBeL7ExS2bkEIXBqAoxMM706+9Z3Kg==
