---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: vernemq
  namespace: home
  annotations:
    fluxcd.io/automated: "true"
    fluxcd.io/tag.chart-image: glob:1.9.*-alpine
spec:
  releaseName: vernemq
  chart:
    repository: https://vernemq.github.io/docker-vernemq/
    name: vernemq
    version: "1.4.4"
  values:
    image:
      repository: erlio/docker-vernemq
      tag: 1.9.2-1-alpine
    service:
      mqtt:
        enabled: true
  valuesFrom:
    - secretKeyRef:
        name: verne-users
        key: users.yaml
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: verne-users
  namespace: home
spec:
  encryptedData:
    users.yaml: AgBwJqQrmhJTPS+p8EaeOkyQaaKbu/x4aBIJegVN+DEhNwW6uNFSZ1IxbK/EDzvKdaYaMcxGQx11g2lfNKu3dQiSnt0nehIu2Fmxgxvt8pGo85UHMnnzJAbWeBQWvsOHe7i36r2QW88V2I+PHCVqK8Py1ysyDwsXMbjkX42bu0x53k2UVSLcEqAHgteGryvl85AiGkSBkMDjuRKS6VABmEtyMx6Sq4vgGSi39ZRdD1Jmm6fhQOxosKz6V/F5AXU/QNMPrOdlwVzfE+b/El9JYHn3sBW+rRxZKTDfVf7imsKULKzSahHRzPRLZn9LGHukacFbAagxQoMlbSE0dqaEBokbbUUukVBX4M/iQty/AIbo5tTwRKZdyxkUKaLKsLEJGpSBI5WqWiObTHBcJsjwLI1LwGeiHHM6oi/1e9J2+9QMniXU8afTyso2noOFQ9ZIRgAcMnXMY5mG8eLWfZIZtNo1EX313+p5uE/Gn7mFWyi79NpvHPGl4J0zlMdq9kl5QBZSpbOX0macOc6aEjd8WiipooGkUfQPcGs4COxd1mxzcyT/jCKgZwnZsh2AJkq7fuPZ/7jj0t4JdpmTHi2SiydXkPmcEiLzwrJSzZqB5pEUdV86q4Je6OqARASG+GIySdA9X7ae/ou/LZABorweXIAOPgk7TsFSPysMhUQNcHu7s/+hiXsWSuYgQmjOxoquNKK1HZyUZ294h+6E96QcOSHal48wJ+3giS4OM9OG+HttfuAHFCtEddg/JsOnb2ZZ+VhCvDDzjypR0ukahKttBzNdzg2kwe0hXn5l9vkYpTRF2eDmyV7Lv3o+fC7iEe9JBg80NWM0YniY+sBSn658+OszjiBxeyT3VUbNc8oiuzUUXPB38WlcXoTAzusq4rFQIUvHj6dHPuecdWkZEw5Vv4L9Ov4k9yFrk4/dcx2AtA2M1MNr6/m1b3CTSsL0wkkDXCvXkqf8uGMMghZNr2RYqvkWf/xf/hgaDNUBAzcndqcs8GRJpUMeSs1y8SuamQl6102JJzCR+GVaW/aRGkxWV12OLFvowcnvcLwyLVRKgG1z2ISeyDYnNBxCl6XQF/xV2tPiXvYleZjQBTXbbfxw5Vnld+NCgqtc15VRt67N
---
apiVersion: voyager.appscode.com/v1beta1
kind: Ingress
metadata:
  namespace: home
  name: vernemq
  labels:
    app.kubernetes.io/instance: vernemq
    app.kubernetes.io/name: vernemq
  annotations:
    kubernetes.io/ingress.class: voyager
    ingress.appscode.com/type: HostPort
spec:
  rules:
    - host: home.okayserver.gq
      tcp:
        port: "8883"
        backend:
          serviceName: vernemq
          servicePort: "1883"
  tls:
    - hosts:
        - home.okayserver.gq
      secretName: home-assistant-tls
